# ğŸŒŸ Explication dÃ©taillÃ©e du script `scriptGLPIv2build1ok.sh`

Ce script Bash automatise l'installation de **GLPI** sur un serveur Linux avec **Apache**, **PHP**, et **MariaDB**. Il configure Ã©galement les permissions et optimise le serveur pour l'exÃ©cution de GLPI.

---

## ğŸš€ 1. VÃ©rification des privilÃ¨ges root
```bash
if [[ $EUID -ne 0 ]]; then
   echo "Ce script doit Ãªtre exÃ©cutÃ© en tant que root"
   exit 1
fi
```
ğŸ”¹ VÃ©rifie si l'utilisateur exÃ©cutant le script est **root** (`EUID = 0`).  
ğŸ”¹ Si ce n'est pas le cas, il affiche un message et **stoppe** l'exÃ©cution.

---

## ğŸŒ 2. Demande du ServerAlias
```bash
read -p "Entrez l'adresse IP ou le nom de domaine pour le ServerAlias : " SERVER_ALIAS
if [ -z "$SERVER_ALIAS" ]; then
    echo "Erreur : L'adresse IP ou le nom de domaine est requis"
    exit 1
fi
```
ğŸ”¹ Demande une **adresse IP** ou un **nom de domaine** pour la configuration Apache.  
ğŸ”¹ VÃ©rifie que la valeur n'est pas vide.

---

## ğŸ”„ 3. Mise Ã  jour du systÃ¨me
```bash
if ! apt update && apt upgrade -y; then
    echo "Erreur lors de la mise Ã  jour du systÃ¨me"
    exit 1
fi
```
ğŸ”¹ Met Ã  jour les paquets du systÃ¨me avec `apt update && apt upgrade -y`.  
ğŸ”¹ ArrÃªte le script en cas d'Ã©chec.

---

## ğŸ› ï¸ 4. Installation des logiciels requis
```bash
if ! apt install apache2 php mariadb-server -y; then
    echo "Erreur lors de l'installation des packages principaux"
    exit 1
fi
```
ğŸ”¹ Installe **Apache**, **PHP** et **MariaDB**.  
ğŸ”¹ ArrÃªte le script si une erreur survient.

### ğŸ“Œ Installation des extensions PHP
```bash
if ! apt install php-{mysql,mbstring,curl,gd,xml,intl,ldap,apcu,xmlrpc,zip,bz2,imap} -y; then
    echo "Erreur lors de l'installation des extensions PHP"
    exit 1
fi
```
ğŸ”¹ Installe les **extensions PHP** nÃ©cessaires pour GLPI.

---

## ğŸ”’ 5. SÃ©curisation de MariaDB
```bash
mysql_secure_installation
```
ğŸ”¹ Lance l'assistant **mysql_secure_installation** pour sÃ©curiser MariaDB.

---

## ğŸ’½ 6. Configuration de la base de donnÃ©es
```bash
read -p "Entrez le nom de la base de donnÃ©es (par dÃ©faut: db_glpi): " DB_NAME
DB_NAME=${DB_NAME:-db_glpi}

read -p "Entrez le nom d'utilisateur de la base de donnÃ©es (par dÃ©faut: admindb_glpi): " DB_USER
DB_USER=${DB_USER:-admindb_glpi}

read -s -p "Entrez le mot de passe pour l'utilisateur de la base de donnÃ©es: " DB_PASSWORD
echo
DB_PASSWORD=${DB_PASSWORD:-123}
```
ğŸ”¹ Demande le **nom de la base**, **nom d'utilisateur**, et **mot de passe** (avec valeurs par dÃ©faut).

### ğŸ“Œ CrÃ©ation de la base de donnÃ©es et assignation des droits
```bash
mysql -u root -p <<EOF
CREATE DATABASE ${DB_NAME};
GRANT ALL PRIVILEGES ON ${DB_NAME}.* TO '${DB_USER}'@'localhost' IDENTIFIED BY '${DB_PASSWORD}';
FLUSH PRIVILEGES;
EXIT;
EOF
```
ğŸ”¹ CrÃ©e la base **GLPI** et donne tous les privilÃ¨ges Ã  l'utilisateur.

---

## ğŸ’¾ 7. Installation de GLPI
```bash
cd /tmp || exit 1
if ! wget https://github.com/glpi-project/glpi/releases/download/10.0.17/glpi-10.0.17.tgz; then
    echo "Erreur lors du tÃ©lÃ©chargement de GLPI"
    exit 1
fi
```
ğŸ”¹ TÃ©lÃ©charge GLPI depuis GitHub.

---

## ğŸ”§ 8. Configuration Apache
```bash
cat <<EOL > /etc/apache2/sites-available/glpi.conf
<VirtualHost *:80>
    ServerAlias $SERVER_ALIAS
    DocumentRoot /var/www/html
    Alias "/glpi" "/var/www/html/glpi/public"
    <Directory /var/www/html/glpi>
        Require all granted
        RewriteEngine On
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ index.php [QSA,L]
    </Directory>
</VirtualHost>
EOL
```
ğŸ”¹ CrÃ©e une configuration Apache pour GLPI.

---

## ğŸ‘‰ 9. RedÃ©marrage et vÃ©rifications
```bash
a2enmod rewrite
a2dissite 000-default.conf
a2ensite glpi.conf
systemctl restart apache2
```
ğŸ”¹ Active `mod_rewrite` et redÃ©marre Apache.

---

## ğŸš€ 10. AccÃ¨s final
```bash
echo "Installation de GLPI terminÃ©e avec succÃ¨s."
echo "AccÃ©dez Ã  http://$SERVER_ALIAS/glpi pour finaliser la configuration."
echo "Base de donnÃ©es : $DB_NAME"
echo "Utilisateur DB : $DB_USER"
exit 0
```
ğŸ”¹ Affiche les informations d'accÃ¨s Ã  GLPI.

---

## ğŸ¡ Conclusion
ğŸ† Ce script automatise **totalement** l'installation de GLPI. Il gÃ¨re :
âœ”ï¸ Installation des dÃ©pendances  
âœ”ï¸ Configuration de la base de donnÃ©es  
âœ”ï¸ ParamÃ©trage Apache et PHP  

ğŸ‰ **AprÃ¨s l'exÃ©cution, ouvrez** `http://<IP_SERVEUR>/glpi` pour finaliser l'installation via l'interface web.
